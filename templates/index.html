{% extends "base.html" %}

{% block title %}我的博客 - 首页{% endblock %}

{% block content %}
    <div class="article-list">
        <h2>文章列表</h2>

        {% if current_user.is_authenticated %}
            <p class="welcome-message">欢迎, <strong>{{ current_user.username }}</strong>!</p>
            <a href="{{ url_for('logout') }}" class="btn btn-secondary">登出</a>
            <a href="{{ url_for('create') }}" class="btn btn-primary">新建文章</a>
        {% else %}
            <a href="{{ url_for('login') }}" class="btn btn-secondary">登录</a>
            <a href="{{ url_for('register') }}" class="btn btn-primary">注册</a>
        {% endif %}

        <ul class="post-list">
            {% for post in posts %}
                <li class="post-item">
                    <h3>{{ post.title }}</h3>
                    <p>{{ post.content }}</p>
                    <small>作者: {{ post.author.username }} | 发布于: {{ post.create_time }}</small>

                    {% if current_user.is_authenticated and current_user.id == post.author_id %}
                        <div class="actions">
                            <a href="{{ url_for('edit', post_id=post.id) }}" class="btn btn-warning">编辑</a>
                            <form action="{{ url_for('delete', post_id=post.id) }}" method="POST">
                                <button type="submit" onclick="return confirm('确定要删除此文章吗？');">删除</button>
                            </form>
                        </div>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}
